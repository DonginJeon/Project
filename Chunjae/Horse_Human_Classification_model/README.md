# 느낀점

여러 CNN 모델을 활용해보면서 모델 간의 성능차이를 알 수 있었다. 정확도를 올리기 위해 이미지 데이터의 전처리가 중요하다는 것을 알 수 있었는데 같은 사진도 다양하게 변형해가면서 데이터셋을 확보할 수 있었다. 하지만 공선성 문제로 무분별한 증강보다는 특징을 살릴 수 있는 적정 수만큼의 증강을 하는 것이 중요하다는 것을 알 수 있었다. 모델 학습 시 기본적인 파라미터 설정에 대한 이해도 할 수 있었다.

---

# 프로젝트 요약

이 프로젝트는 말과 사람의 이미지를 분류하는 딥러닝 모델을 구현하고 그 성능을 비교하는 것을 목표로 합니다. 이를 위해 CNN(Sequential), VGG16, ResNet50v2 세 가지 모델을 사용하여 각 모델의 성능을 분석하였고, 최종적으로 **ResNet50v2** 모델이 가장 높은 성능을 기록하여 최적의 모델로 선정되었습니다. 이 보고서에서는 모델 성능을 높이기 위한 다양한 접근 방법과 개선 방안을 제안하였습니다.

---

## 프로젝트 개요

### 기획 의도

이 프로젝트는 CNN(Convolutional Neural Network)을 기반으로 말과 사람 이미지를 분류하는 모델을 구현하는 것을 목적으로 합니다. 이를 위해 **Sequential 모델**, **VGG16**, **ResNet50v2** 세 가지 모델을 선정하여 동일한 데이터셋으로 학습 및 테스트를 진행하였고, 성능을 비교하였습니다.

### 사용된 데이터셋

데이터셋은 [Horses or Humans 데이터셋](https://laurencemoroney.com/datasets.html)을 사용하였습니다. 말과 사람 이미지 데이터를 포함하며, 각 이미지는 300x300 픽셀 크기로 제공됩니다.

- **전체 샘플 수**: 1027장
- **말 이미지**: 500장
- **사람 이미지**: 527장

### 데이터 전처리

이미지 데이터를 학습하기 전에, 추가적인 데이터 전처리를 수행하였습니다:

1. **말 이미지**:

   - 머리: 354장의 말 머리 이미지에 대해 마스킹 처리를 적용하였으며, 흑백 마스킹을 랜덤으로 적용하였습니다.
   - 다리: 250장의 말 다리 이미지에 대해 사진의 윗부분을 블러 처리하였습니다.
   - 방향 변경: 말 이미지의 다양성을 위해 90도 회전한 이미지를 추가하였습니다.
   - 배경제거: 일부 이미지는 배경을 가우시안 블러 처리하여 대상에 집중할 수 있도록 처리하였습니다.

2. **사람 이미지**:
   - 머리: 331장의 사람 머리 이미지를 흑백 마스킹 처리하였습니다.
   - 방향 변경: 사람 이미지의 방향을 좌우로 회전하여 다양한 방향성을 추가하였습니다.
   - 배경제거: 배경이 다양한 사람 이미지에 대해서도 블러 처리를 적용하여 배경을 제거하였습니다.

---

## 사용된 모델

### 1. CNN (Sequential)

기본 CNN 모델로, TensorFlow의 `Sequential` 함수를 사용하여 구축하였습니다. 여러 Conv2D 레이어와 MaxPooling 레이어를 사용하여 이미지 특징을 추출합니다.

- **Layer 구성**:

  - Conv2D 레이어: 말과 사람 이미지의 저수준 특징을 추출
  - MaxPooling2D 레이어: 이미지 크기를 축소하고 중요한 특징만 추출
  - Flatten 및 Dense 레이어: 이미지 특징을 기반으로 최종 분류 수행

- **학습 파라미터**:
  - **Learning Rate**: 0.001
  - **Batch Size**: 128
  - **Epochs**: 15
  - **Optimizer**: Adam
  - **Loss Function**: Binary Crossentropy
  - **Metrics**: Accuracy

### 2. VGG16

사전 학습된 VGG16 모델을 사용하여 이진 분류에 맞게 수정하였습니다. 상단의 분류 레이어를 제거하고 새로운 분류 레이어를 추가하여 이진 분류 작업을 수행하였습니다.

- **Layer 구성**:

  - 기존 VGG16 모델의 특징 추출 레이어 사용
  - GlobalAveragePooling2D 레이어로 3차원 출력 → 1차원 벡터 변환
  - Dense 레이어: 이진 분류를 위한 분류 레이어 추가

- **학습 파라미터**:
  - **Learning Rate**: 1e-5
  - **Batch Size**: 64
  - **Epochs**: 20
  - **Optimizer**: Adam
  - **Loss Function**: Binary Crossentropy
  - **Metrics**: Accuracy

### 3. ResNet50v2

ResNet50v2 모델은 잔차 연결 덕분에 안정적인 학습이 가능하며, 작은 데이터셋에도 적합한 모델입니다. 이 프로젝트에서는 과적합을 방지하기 위해 일부 레이어만 훈련 가능하도록 설정하였습니다.

- **Layer 구성**:

  - 기존 ResNet50v2 모델 구조를 사용
  - Dense 레이어와 Dropout 레이어를 통해 이진 분류 작업 수행

- **학습 파라미터**:
  - **Learning Rate**: 0.001
  - **Batch Size**: 32
  - **Epochs**: 10
  - **Optimizer**: Adam
  - **Loss Function**: Binary Crossentropy
  - **Metrics**: Accuracy

---

## 모델 성능 비교

| 모델       | Precision | Recall | Accuracy | F1 Score |
| ---------- | --------- | ------ | -------- | -------- |
| CNN        | 54.52%    | 54.50% | 37.46%   | 54.44%   |
| VGG16      | 87.90%    | 58.00% | 75%      | 69.90%   |
| ResNet50v2 | 95.74%    | 90.00% | 93%      | 92.78%   |

ResNet50v2 모델이 모든 성능 지표에서 가장 우수한 결과를 보였습니다. 따라서 최종적으로 ResNet50v2를 최적의 모델로 선정하였습니다.

---

## 개선점

1. **실루엣 처리**:
   실루엣 이미지에 대한 인식 성능을 높이기 위해 실루엣 이미지(검정색 또는 하얀색으로 처리된 이미지)를 추가하는 방법을 고려하고 있습니다.

2. **데이터 다양성 확보**:
   사람 이미지의 경우 말 이미지에 비해 종류가 다양하지 않았으며, 공선성이 높았습니다. 이를 해결하기 위해 더 다양한 사람 이미지를 포함한 데이터셋을 구성하는 것이 필요합니다.

---

## 데이터 및 코드 출처

- **훈련 데이터셋**: [Horses or Humans Dataset](https://laurencemoroney.com/datasets.html)
- **테스트 데이터 출처**: [Pixabay](https://pixabay.com/ko/)
- **모델 구현 참고**: [Keras Sequential Model Guide](https://keras.io/guides/sequential_model/)
